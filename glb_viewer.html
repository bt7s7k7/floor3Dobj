<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GLB Viewer - Example5 from Docker API</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }
        
        #container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        
        #info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 12px;
            z-index: 100;
            max-width: 350px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        h3 {
            margin-top: 0;
            color: #4fc3f7;
            font-size: 22px;
        }
        
        .success-badge {
            background: linear-gradient(45deg, #4caf50, #8bc34a);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }
        
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 28px;
            z-index: 200;
            text-align: center;
            background: rgba(0,0,0,0.9);
            padding: 40px;
            border-radius: 15px;
            backdrop-filter: blur(15px);
        }
        
        .loading-spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 4px solid #4fc3f7;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="loading">
            <div class="loading-spinner"></div>
            Naƒç√≠tavam GLB model z Docker API...
        </div>
        
        <div id="info">
            <h3>üê≥ GLB Viewer - Docker API</h3>
            <span class="success-badge">‚úÖ GLB SUCCESS</span>
            
            <p><strong>Model:</strong> example5_from_docker_api.glb</p>
            <p><strong>Veƒækos≈•:</strong> 227KB</p>
            <p><strong>Form√°t:</strong> GLB (Binary glTF 2.0)</p>
            <p><strong>Zdroj:</strong> Docker API ‚Üí Base64 ‚Üí GLB</p>
            
            <p><strong>üéÆ Ovl√°danie:</strong></p>
            <ul>
                <li>üñ±Ô∏è ƒΩav√© tlaƒç√≠tko: Ot√°ƒçanie</li>
                <li>üé° Koliesko: Zoom</li>
                <li>üñ±Ô∏è Prav√© tlaƒç√≠tko: Posun</li>
            </ul>
            
            <p><strong>üìä Workflow:</strong></p>
            <p>PNG ‚Üí AI ‚Üí Blender ‚Üí GLB ‚Üí Base64 ‚Üí API ‚Üí GLB</p>
        </div>
    </div>

    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <script>
        // Glob√°lne premenn√©
        let scene, camera, renderer, controls, model;

        // Inicializ√°cia
        function init() {
            console.log('üöÄ Inicializujem GLB viewer...');
            
            // Sc√©na
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x1e3c72);
            scene.fog = new THREE.Fog(0x1e3c72, 50, 200);

            // Kamera
            camera = new THREE.PerspectiveCamera(
                75, 
                window.innerWidth / window.innerHeight, 
                0.1, 
                1000
            );
            camera.position.set(20, 20, 20);

            // Renderer
            renderer = new THREE.WebGLRenderer({ 
                antialias: true,
                alpha: true
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            renderer.outputEncoding = THREE.sRGBEncoding;
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.0;
            
            document.getElementById('container').appendChild(renderer.domElement);

            // Ovl√°danie
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.enableZoom = true;
            controls.autoRotate = false;

            // Osvetlenie
            setupLighting();

            // Naƒç√≠tanie GLB modelu
            loadGLBModel();

            // Event listenery
            window.addEventListener('resize', onWindowResize, false);
        }

        function setupLighting() {
            // Ambientn√© svetlo
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);

            // Hlavn√© smerov√© svetlo
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1.0);
            directionalLight.position.set(30, 30, 20);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            scene.add(directionalLight);

            // Vypl≈àovacie svetlo
            const fillLight = new THREE.DirectionalLight(0x87ceeb, 0.4);
            fillLight.position.set(-20, 20, -20);
            scene.add(fillLight);
        }

        function loadGLBModel() {
            const loader = new THREE.GLTFLoader();
            
            console.log('üì¶ Naƒç√≠tavam GLB model z Docker API...');
            
            loader.load(
                'example5_from_docker_api.glb',
                function(gltf) {
                    model = gltf.scene;
                    
                    console.log('‚úÖ GLB model √∫spe≈°ne naƒç√≠tan√Ω!', gltf);
                    
                    // Nastavenie materi√°lov a tie≈àov
                    model.traverse(function(child) {
                        if (child.isMesh) {
                            child.castShadow = true;
                            child.receiveShadow = true;
                            
                            if (child.material) {
                                child.material.side = THREE.DoubleSide;
                            }
                        }
                    });
                    
                    scene.add(model);
                    
                    // Vycentrovanie modelu
                    const box = new THREE.Box3().setFromObject(model);
                    const center = box.getCenter(new THREE.Vector3());
                    const size = box.getSize(new THREE.Vector3());
                    
                    model.position.sub(center);
                    
                    // Optim√°lne poz√≠ciovanie kamery
                    const maxDim = Math.max(size.x, size.y, size.z);
                    const distance = maxDim * 2;
                    
                    camera.position.set(distance, distance * 0.8, distance);
                    controls.target.set(0, size.y / 4, 0);
                    controls.update();
                    
                    // Skry≈• loading
                    document.getElementById('loading').style.display = 'none';
                    
                    console.log(`üìê Model vycentrovan√Ω. Rozmer: ${size.x.toFixed(1)} x ${size.y.toFixed(1)} x ${size.z.toFixed(1)}`);
                },
                function(progress) {
                    const percent = (progress.loaded / progress.total * 100).toFixed(1);
                    document.getElementById('loading').innerHTML = `
                        <div class="loading-spinner"></div>
                        Naƒç√≠tavam GLB model... ${percent}%
                    `;
                },
                function(error) {
                    console.error('‚ùå Chyba pri naƒç√≠tan√≠ GLB modelu:', error);
                    document.getElementById('loading').innerHTML = `
                        ‚ùå Chyba pri naƒç√≠tan√≠ GLB modelu!<br>
                        <small>Skontrolujte konzolu pre detaily.</small>
                    `;
                }
            );
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // Animaƒçn√° sluƒçka
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        // Spustenie
        console.log('üê≥ Sp√∫≈°≈•am GLB Viewer pre Docker API model...');
        init();
        animate();
    </script>
</body>
</html>
